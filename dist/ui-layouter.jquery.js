"use strict";(function(a){'use strict';a.fn.uiLayouter=function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},c=this,d={maxColumns:!1,classes:{},createRow:function(){return a("<div>")},createColumn:function(){return a("<div>")},createItem:function(b,c){return a("<div><div class=\"handle\" draggable=\"true\"></div><span>".concat(c.text(),"</span></div>"))},createPreview:function(b,c){return a("<div>",{text:c.text()})}},e=a.extend(!0,d,b),f=a.extend({builder:"ui-layouter-js",row:"ui-layouter-js__row",column:"ui-layouter-js__column",empty:"ui-layouter-js__empty",item:"ui-layouter-js__item",preview:"ui-layouter-js__preview",dragging:"ui-layouter-js__dragging",dragover:"ui-layouter-js__dragover"},e.classes||{}),g={$item:null,$preview:null},h=function(a){for(var b=arguments.length,f=Array(1<b?b-1:0),g=1;g<b;g++)f[g-1]=arguments[g];return"function"==typeof e[a]?e[a].apply(e,[c].concat(f)):"function"==typeof d[a]?d[a].apply(d,[c].concat(f)):void 0},i=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return h.apply(void 0,["createRow"].concat(b)).addClass(f.row)},j=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return h.apply(void 0,["createColumn"].concat(b)).addClass(f.column)},k=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return h.apply(void 0,["createItem"].concat(b)).addClass(f.item)},l=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return h.apply(void 0,["createPreview"].concat(b)).addClass(f.preview)},m=function(){g.$item&&(g.$preview=l(g.$item),c.append(g.$preview))},n=function(){g.$preview&&(g.$preview.remove(),g.$preview=null)},o=function(a){a.closest(".".concat(f.column)).addClass(f.empty);var b=0===a.closest(".".concat(f.row)).find(".".concat(f.column,":not(.").concat(f.empty,")")).length;b&&a.closest(".".concat(f.row)).addClass(f.empty)},p=function(){var b=".".concat(f.row),d=".".concat(f.column),e=i().addClass(f.empty),g=j().addClass(f.empty);c.find("".concat(d,".").concat(f.empty)).remove(),c.find("".concat(b,".").concat(f.empty)).remove(),c.find(b).length&&(c.find(b).each(function(){e.clone().insertBefore(a(this))}),c.append(e.clone()),c.find(b).not(".".concat(f.empty)).each(function(){var b=a(this),c=b.find(d).not(".".concat(f.empty));c.length&&(c.each(function(){g.clone().insertBefore(a(this))}),b.append(g.clone()))}))};return c.on("dragstart","[draggable=\"true\"], [draggable]",function(b){c.addClass(f.dragging),g.$item=c.getItem(a(this)),m();var d=new Image;d.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",b.originalEvent.dataTransfer.setDragImage(d,0,0)}),c.on("dragend","[draggable=\"true\"], [draggable]",function(){c.removeClass(f.dragging),c.find(".".concat(f.dragover)).removeClass(f.dragover),n()}),c.on("dragenter",".".concat(f.row,".").concat(f.empty,", .").concat(f.column,".").concat(f.empty),function(){a(this).addClass(f.dragover)}),c.on("dragleave",".".concat(f.row,".").concat(f.empty,", .").concat(f.column,".").concat(f.empty),function(){a(this).removeClass(f.dragover)}),c.on("dragover",".".concat(f.row,".").concat(f.empty,", .").concat(f.column,".").concat(f.empty),function(a){a.preventDefault()}),c.on("drop",".".concat(f.row,".").concat(f.empty,", .").concat(f.column,".").concat(f.empty),function(b){b.preventDefault();var c=a(b.target);if(c.is(".".concat(f.row))){var d=j();o(g.$item),d.append(g.$item),c.append(d),c.removeClass(f.empty)}else if(c.is(".".concat(f.column))){var h=c.closest(".".concat(f.row)).find(".".concat(f.column)),i=!e.maxColumns||e.maxColumns&&h.not(".".concat(f.empty)).length<e.maxColumns;i&&(o(g.$item),c.append(g.$item),c.removeClass(f.empty))}n(),p()}),a(document).on("mousemove dragover",function(b){g.$preview&&g.$preview.css({top:100*(b.clientY/a(window).height())+"%",left:100*(b.clientX/a(window).width())+"%"})}),c.getItem=function(a){return a.closest(".".concat(f.item))},c.addItem=function(a){var b=i(),d=j(),e=k(a);return d.append(e),b.append(d),c.append(b),p(),e},c.removeItem=function(a){var b=c.getItem(a);o(b),b.remove(),p()},function(){c.addClass(f.builder)}(),c}})(jQuery);